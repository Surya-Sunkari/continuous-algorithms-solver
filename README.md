# CS 395T Homework Solver

A Claude Code-powered tool that generates mathematically rigorous LaTeX solutions for CS 395T (Continuous Algorithms) homework assignments. Uses a multi-subagent verification pipeline to maximize proof correctness.

## Prerequisites

- [Claude Code](https://claude.com/claude-code) installed and configured
- [MiKTeX](https://miktex.org/) (or another LaTeX distribution with `pdflatex` on PATH)

## Quick Start

### 1. Set up an assignment

Create the folder structure for your assignment:

```
homework_solver/
└── assignment1/
    ├── homework.pdf              # Option A: full homework PDF
    ├── screenshots/              # Option B: one folder per problem with images
    │   ├── problem1/
    │   │   ├── page1.png
    │   │   └── page2.png
    │   ├── problem2/
    │   │   └── screenshot.png
    │   └── ...
    ├── problems/                 # Option C: .tex files directly (skip /convert)
    │   ├── p1.tex
    │   ├── p2.tex
    │   └── ...
    └── notes/
        ├── lecture1.pdf
        ├── lecture2.pdf
        └── ...
```

- **`homework.pdf`** — The full homework PDF. `/convert` will auto-detect it, split by problem boundaries, and extract each problem (including footnotes) into separate `.tex` files.
- **`screenshots/`** — One subfolder per problem (`problem1/`, `problem2/`, ...) containing screenshot images of the problem statement.
- **`problems/`** — One `.tex` file per problem. Each file contains the problem statement (just the math content, no preamble or `\begin{document}`). Can be created manually or generated by `/convert`.
- **`notes/`** — PDF files of the lecture notes relevant to this assignment.

### 2a. Convert homework to LaTeX (if starting from PDF or screenshots)

```
/convert assignment1
```

The skill auto-detects the input format:
- **PDF mode**: Finds `homework.pdf` in the assignment folder, identifies problem boundaries, splits into individual `.tex` files with footnotes attached to the correct problems.
- **Screenshot mode**: Reads images from `screenshots/problemN/` folders and transcribes each.

In both modes, each transcription is verified by a separate subagent for accuracy.

### 2b. Run the solver

```
/solve assignment1
```

### 3. Get your solution

The tool generates `assignment1/solution.tex` — a complete, compilable LaTeX document. It also compiles it to PDF via `pdflatex` automatically.

## What `/convert` Does

The `/convert` skill converts a homework PDF or problem screenshots into exact LaTeX:

| Phase | What happens |
|-------|-------------|
| **1. Input Detection** | Auto-detects PDF mode (`.pdf` in assignment folder) or screenshot mode (`screenshots/` with subfolders) |
| **2. Conversion** | **PDF mode**: reads full PDF → identifies problem boundaries and footnotes → transcribes each problem separately. **Screenshot mode**: reads images per problem folder → transcribes each. Both modes use opus subagents. |
| **3. Verification** | Each transcription is verified symbol-by-symbol by a separate opus subagent. Auto-retries up to 3 times on discrepancies. |
| **4. Report** | Lists which problems were converted and any that need manual review |

Footnotes are matched to their corresponding problems and included inline using `\footnote{}`.

## What `/solve` Does

The `/solve` skill runs a 6-phase pipeline:

| Phase | What happens |
|-------|-------------|
| **1. Validation** | Checks that `problems/` and `notes/` exist with the right files |
| **2. Knowledge Base Indexing** | Reads lecture PDFs, extracts theorems/definitions/lemmas into `knowledge_base/` as YAML. Skips already-indexed lectures. |
| **3. Problem Analysis** | Reads all problems, identifies relevant theorems, determines proof strategies |
| **4. Solution Generation** | Per problem: drafts solution → verifies proof correctness → checks style/formatting (3 separate subagents, with auto-retry on errors) |
| **5. Assembly** | Combines all solutions into a single `solution.tex` matching `example.tex` formatting |
| **6. Compilation** | Runs `pdflatex` and auto-fixes any LaTeX errors (up to 3 attempts) |

### Verification Pipeline (Phase 4 detail)

Each problem goes through three subagents:

1. **Solution Generator** — Produces a complete proof with full derivations, citing lecture theorems
2. **Proof Verifier** — Independently checks every logical step, inequality direction, theorem hypothesis, and edge case
3. **Style Checker** — Ensures LaTeX formatting matches `example.tex` and the writing doesn't sound AI-generated

If the verifier finds errors, the solution is regenerated with feedback and re-verified (up to 3 attempts per problem).

## Knowledge Base

Theorems extracted from lecture notes are saved in `knowledge_base/` as YAML files (one per lecture). These persist across assignments, so theorems from earlier lectures are available when solving later homework.

Example entry:

```yaml
source: "lecture5.pdf"
lecture_number: 5
title: "Gradient Descent and Smoothness"
items:
  - type: theorem
    number: "5.3"
    name: ""
    statement: |
      If f is L-smooth and convex, then gradient descent
      with step size 1/L satisfies f(x_T) - f(x*) ≤ ...
    context: "Key convergence result for smooth optimization"
```

## Formatting

All solutions match the style of `example.tex`:

- `\section*{Problem N}` headings, `\subsection*{(i)}` subparts
- `\begin{proof}...\end{proof}` environments
- `align*` for multi-line math, `\[...\]` for display math
- Citations as `By Theorem X.Y (Lecture Z)`
- No problem restatement — solutions only

## File Structure

```
homework_solver/
├── README.md                    # This file
├── CLAUDE.md                    # Claude Code project instructions
├── example.tex                  # Formatting template (do not modify)
├── knowledge_base/              # Auto-populated theorem database
│   ├── lecture1.yaml
│   └── ...
├── .claude/
│   └── skills/
│       ├── solve/
│       │   └── SKILL.md         # The solver skill
│       └── convert/
│           └── SKILL.md         # The PDF/screenshot-to-LaTeX converter
├── assignment1/
│   ├── homework.pdf             # Input for /convert (PDF mode)
│   ├── screenshots/             # Input for /convert (screenshot mode)
│   ├── problems/                # Input for /solve (or output of /convert)
│   ├── notes/
│   └── solution.tex             # Generated output
└── assignment2/
    └── ...
```
