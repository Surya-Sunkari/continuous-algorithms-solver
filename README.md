# CS 395T Homework Solver

A Claude Code-powered tool that generates mathematically rigorous LaTeX solutions for CS 395T (Continuous Algorithms) homework assignments. Uses a multi-subagent verification pipeline to maximize proof correctness.

## Prerequisites

- [Claude Code](https://claude.com/claude-code) installed and configured
- [MiKTeX](https://miktex.org/) (or another LaTeX distribution with `pdflatex` on PATH)

## Quick Start

### 1. Set up an assignment

Create the folder structure for your assignment:

```
homework_solver/
└── assignment1/
    ├── homework.pdf              # Option A: full homework PDF
    ├── problems/                 # Option B: .tex files directly (skip /convert)
    │   ├── p1.tex
    │   ├── p2.tex
    │   └── ...
    └── notes/
        ├── lecture1.pdf
        ├── lecture2.pdf
        └── ...
```

- **`homework.pdf`** — The full homework PDF. `/convert` will auto-detect it, split by problem boundaries, and extract each problem (including footnotes) into separate `.tex` files.
- **`problems/`** — One `.tex` file per problem. Each file contains the problem statement (just the math content, no preamble or `\begin{document}`). Can be created manually or generated by `/convert`.
- **`notes/`** — PDF files of the lecture notes relevant to this assignment.

### 2. Convert homework to LaTeX (if starting from PDF)

```
/convert assignment1
```

Reads the homework PDF, identifies problem boundaries and footnotes, and splits into `assignment1/problems/p1.tex`, `p2.tex`, etc. Each transcription is verified by a separate subagent.

### 3. Index lecture notes

```
/learn assignment1
```

Reads all PDFs in `assignment1/notes/`, extracts theorems, definitions, and lemmas into `knowledge_base/` as structured YAML. Skips already-indexed lectures. The knowledge base persists across assignments.

### 4. Solve individual problems

```
/solve assignment1 1
/solve assignment1 2
/solve assignment1 3
```

Each call solves a single problem using a 3-subagent verification pipeline and writes the result to `assignment1/solutions/p1.tex`, etc.

### 5. Assemble and compile

```
/combine assignment1
```

Combines all solved problems into `assignment1/solution.tex` and compiles to PDF via `pdflatex`.

## Skills

### `/convert assignmentN`

Converts a homework PDF into individual problem `.tex` files.

| Phase | What happens |
|-------|-------------|
| **1. Input Detection** | Finds the PDF in the assignment folder |
| **2. Conversion** | Reads full PDF, identifies problem boundaries and footnotes, transcribes each problem to LaTeX |
| **3. Verification** | Each transcription verified symbol-by-symbol by a separate opus subagent. Auto-retries up to 3 times. |
| **4. Report** | Lists which problems were converted and any that need manual review |

### `/learn assignmentN`

Indexes lecture notes into the knowledge base.

| Phase | What happens |
|-------|-------------|
| **1. Validation** | Checks `notes/` exists with PDFs |
| **2. Indexing** | Reads each PDF, extracts theorems/definitions/lemmas/corollaries into YAML. Skips already-indexed files. |
| **3. Report** | Lists how many items were extracted |

### `/solve assignmentN problemNumber`

Solves a single problem with verified proofs.

| Phase | What happens |
|-------|-------------|
| **1. Validation** | Checks that the problem file and knowledge base exist |
| **2. Analysis** | Reads the problem, identifies relevant theorems from the knowledge base |
| **3. Solution** | 3-subagent pipeline: draft (opus) → verify (opus) → style check (sonnet). Auto-retries up to 3 times on errors. |
| **4. Output** | Writes verified solution to `assignmentN/solutions/pN.tex` |

#### Verification Pipeline

Each problem goes through three subagents:

1. **Solution Generator** — Produces a complete proof with full derivations, citing lecture theorems
2. **Proof Verifier** — Independently checks every logical step, inequality direction, theorem hypothesis, and edge case
3. **Style Checker** — Ensures LaTeX formatting matches `example.tex` and the writing doesn't sound AI-generated

If the verifier finds errors, the solution is regenerated with feedback and re-verified (up to 3 attempts).

### `/combine assignmentN`

Assembles and compiles the final document.

| Phase | What happens |
|-------|-------------|
| **1. Validation** | Checks that `solutions/` exists with solved problem files |
| **2. Assembly** | Combines all solutions into `solution.tex` with preamble from `example.tex` |
| **3. Compilation** | Runs `pdflatex`, auto-fixes errors (up to 3 attempts) |
| **4. Report** | Confirms output location and compilation status |

## Knowledge Base

Theorems extracted from lecture notes are saved in `knowledge_base/` as YAML files (one per lecture). These persist across assignments, so theorems from earlier lectures are available when solving later homework.

Example entry:

```yaml
source: "lecture5.pdf"
lecture_number: 5
title: "Gradient Descent and Smoothness"
items:
  - type: theorem
    number: "5.3"
    name: ""
    statement: |
      If f is L-smooth and convex, then gradient descent
      with step size 1/L satisfies f(x_T) - f(x*) ≤ ...
    context: "Key convergence result for smooth optimization"
```

## Formatting

All solutions match the style of `example.tex`:

- `\section*{Problem N}` headings, `\subsection*{(i)}` subparts
- `\begin{proof}...\end{proof}` environments
- `align*` for multi-line math, `\[...\]` for display math
- Citations as `By Theorem X.Y (Lecture Z)`
- No problem restatement — solutions only

## File Structure

```
homework_solver/
├── README.md                    # This file
├── CLAUDE.md                    # Claude Code project instructions
├── example.tex                  # Formatting template (do not modify)
├── knowledge_base/              # Auto-populated theorem database
│   ├── lecture1.yaml
│   └── ...
├── .claude/
│   └── skills/
│       ├── convert/
│       │   └── SKILL.md         # PDF-to-LaTeX converter
│       ├── learn/
│       │   └── SKILL.md         # Knowledge base indexer
│       ├── solve/
│       │   └── SKILL.md         # Single problem solver
│       └── combine/
│           └── SKILL.md         # Solution assembler + compiler
├── assignment1/
│   ├── homework.pdf             # Input for /convert
│   ├── problems/                # Input for /solve (or output of /convert)
│   ├── notes/                   # Input for /learn
│   ├── solutions/               # Output of /solve (individual problems)
│   └── solution.tex             # Output of /combine (final document)
└── assignment2/
    └── ...
```
